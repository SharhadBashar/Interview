"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _isotropicError = _interopRequireDefault(require("isotropic-error"));
var _isotropicLater = _interopRequireDefault(require("isotropic-later"));
var _isotropicMake = _interopRequireDefault(require("isotropic-make"));
var _isotropicPubsub = _interopRequireDefault(require("isotropic-pubsub"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
var _default = (0, _isotropicMake.default)(_isotropicPubsub.default, {
  closeGate({
    gateId
  }) {
    return this._simulateRequestResponse(() => this._closeGate({
      gateId
    }));
  },
  fetchGateIdSet() {
    return this._simulateRequestResponse(() => this._fetchGateIdSet());
  },
  fetchGateStatus({
    gateId
  }) {
    return this._simulateRequestResponse(() => this._fetchGateStatus({
      gateId
    }));
  },
  openGate({
    gateId
  }) {
    return this._simulateRequestResponse(() => this._openGate({
      gateId
    }));
  },
  _closeGate({
    gateId
  }) {
    switch (this._gateStatusById[gateId]) {
      case 'closed':
      case 'closing':
      case 'opening':
        throw (0, _isotropicError.default)({
          details: {
            gateId
          },
          message: '409 Can not close gate at this time'
        });
      case 'open':
        break;
      default:
        throw (0, _isotropicError.default)({
          details: {
            gateId
          },
          message: '404 Gate not found'
        });
    }
    if (this._isClosingOrOpening) {
      throw (0, _isotropicError.default)({
        details: {
          gateId
        },
        message: '409 Can not close gate at this time'
      });
    }
    return new Promise(resolve => {
      this._after('gateClosed', event => {
        if (event.data.gateId === gateId) {
          event.unsubscribe();
          resolve();
        }
      });
      this._publish('gateClosing', {
        gateId
      });
    });
  },
  get _delay() {
    return Math.random() * 144;
  },
  _eventGateClosed({
    data: {
      gateId
    }
  }) {
    this._gateStatusById[gateId] = 'closed';
    this._log(`gate ${gateId} closed`);
    (0, _isotropicLater.default)(this._cooldownDuration, () => {
      this._publish('ready');
    });
  },
  _eventGateClosing({
    data: {
      gateId
    }
  }) {
    this._gateStatusById[gateId] = 'closing';
    this._isClosingOrOpening = true;
    this._log(`gate ${gateId} closing`);
    (0, _isotropicLater.default)(this._delay + this._closeDuration, () => {
      this._publish('gateClosed', {
        gateId
      });
    });
  },
  _eventGateOpen({
    data: {
      gateId
    }
  }) {
    this._gateStatusById[gateId] = 'open';
    this._log(`gate ${gateId} open`);
    (0, _isotropicLater.default)(this._cooldownDuration, () => {
      this._publish('ready');
    });
  },
  _eventGateOpening({
    data: {
      gateId
    }
  }) {
    this._gateStatusById[gateId] = 'opening';
    this._isClosingOrOpening = true;
    this._log(`gate ${gateId} opening`);
    (0, _isotropicLater.default)(this._delay + this._openDuration, () => {
      this._publish('gateOpen', {
        gateId
      });
    });
  },
  _eventReady() {
    this._isClosingOrOpening = false;
    this._log('gate manager ready');
  },
  _fetchGateIdSet() {
    this._log(`gate ids: ${Array.from(this._gateIdSet).join(', ')}`);
    return new Set(this._gateIdSet);
  },
  _fetchGateStatus({
    gateId
  }) {
    const gateStatus = this._gateStatusById[gateId];
    if (!gateStatus) {
      throw (0, _isotropicError.default)({
        details: {
          gateId
        },
        message: '404 Gate not found'
      });
    }
    this._log(`gate ${gateId} is ${gateStatus}`);
    return gateStatus;
  },
  _init({
    closeDuration = 377,
    cooldownDuration = 987,
    gateStatusById = {},
    openDuration = 610
  } = {}) {
    Reflect.apply(_isotropicPubsub.default.prototype._init, this, []);
    this._closeDuration = closeDuration;
    this._cooldownDuration = cooldownDuration;
    this._gateIdSet = new Set(Object.keys(gateStatusById));
    this._gateStatusById = gateStatusById;
    this._initTime = Date.now();
    this._isClosingOrOpening = false;
    this._openDuration = openDuration;
    return this._validateStatus();
  },
  _log(message) {
    console.log(Date.now() - this._initTime, message);
  },
  _openGate({
    gateId
  }) {
    switch (this._gateStatusById[gateId]) {
      case 'closed':
        break;
      case 'closing':
      case 'open':
      case 'opening':
        throw (0, _isotropicError.default)({
          details: {
            gateId
          },
          message: '409 Can not open gate at this time'
        });
      default:
        throw (0, _isotropicError.default)({
          details: {
            gateId
          },
          message: '404 Gate not found'
        });
    }
    if (this._isClosingOrOpening) {
      throw (0, _isotropicError.default)({
        details: {
          gateId
        },
        message: '409 Can not open gate at this time'
      });
    }
    return new Promise(resolve => {
      this._after('gateOpen', event => {
        if (event.data.gateId === gateId) {
          event.unsubscribe();
          resolve();
        }
      });
      this._publish('gateOpening', {
        gateId
      });
    });
  },
  _simulateRequestResponse(handleFunction) {
    return new Promise((resolve, reject) => {
      (0, _isotropicLater.default)(this._delay, async () => {
        try {
          const returnValue = await handleFunction();
          (0, _isotropicLater.default)(this._delay, () => {
            resolve(returnValue);
          });
        } catch (error) {
          (0, _isotropicLater.default)(this._delay, () => {
            reject((0, _isotropicError.default)({
              error
            }));
          });
        }
      });
    });
  },
  _validateStatus() {
    let isClosingOrOpening = false;
    for (const gateId of this._gateIdSet) {
      const gateStatus = this._gateStatusById[gateId];
      switch (gateStatus) {
        case 'closed':
        case 'open':
          break;
        case 'closing':
        case 'opening':
          if (isClosingOrOpening) {
            throw (0, _isotropicError.default)({
              details: {
                gateId
              },
              message: 'Multiple gates can not be closed or opened at the same time'
            });
          }
          isClosingOrOpening = true;
          break;
        default:
          throw (0, _isotropicError.default)({
            details: {
              gateId,
              gateStatus
            },
            message: 'Gate has invalid status'
          });
      }
    }
    this._isClosingOrOpening = isClosingOrOpening;
    this._publish('ready');
    return this;
  }
}, {
  _events: {
    gateClosed: {
      allowPublicPublish: false,
      allowPublicSubscription: false,
      allowPublicUnsubscription: false,
      defaultFunction: '_eventGateClosed'
    },
    gateClosing: {
      allowPublicPublish: false,
      allowPublicSubscription: false,
      allowPublicUnsubscription: false,
      defaultFunction: '_eventGateClosing'
    },
    gateOpen: {
      allowPublicPublish: false,
      allowPublicSubscription: false,
      allowPublicUnsubscription: false,
      defaultFunction: '_eventGateOpen'
    },
    gateOpening: {
      allowPublicPublish: false,
      allowPublicSubscription: false,
      allowPublicUnsubscription: false,
      defaultFunction: '_eventGateOpening'
    },
    ready: {
      allowPublicPublish: false,
      allowPublicSubscription: false,
      allowPublicUnsubscription: false,
      defaultFunction: '_eventReady'
    }
  }
});
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbWFrZSIsIl9QdWJzdWIiLCJjbG9zZUdhdGUiLCJnYXRlSWQiLCJfc2ltdWxhdGVSZXF1ZXN0UmVzcG9uc2UiLCJfY2xvc2VHYXRlIiwiZmV0Y2hHYXRlSWRTZXQiLCJfZmV0Y2hHYXRlSWRTZXQiLCJmZXRjaEdhdGVTdGF0dXMiLCJfZmV0Y2hHYXRlU3RhdHVzIiwib3BlbkdhdGUiLCJfb3BlbkdhdGUiLCJfZ2F0ZVN0YXR1c0J5SWQiLCJfRXJyb3IiLCJkZXRhaWxzIiwibWVzc2FnZSIsIl9pc0Nsb3NpbmdPck9wZW5pbmciLCJQcm9taXNlIiwicmVzb2x2ZSIsIl9hZnRlciIsImV2ZW50IiwiZGF0YSIsInVuc3Vic2NyaWJlIiwiX3B1Ymxpc2giLCJfZGVsYXkiLCJNYXRoIiwicmFuZG9tIiwiX2V2ZW50R2F0ZUNsb3NlZCIsIl9sb2ciLCJfbGF0ZXIiLCJfY29vbGRvd25EdXJhdGlvbiIsIl9ldmVudEdhdGVDbG9zaW5nIiwiX2Nsb3NlRHVyYXRpb24iLCJfZXZlbnRHYXRlT3BlbiIsIl9ldmVudEdhdGVPcGVuaW5nIiwiX29wZW5EdXJhdGlvbiIsIl9ldmVudFJlYWR5IiwiQXJyYXkiLCJmcm9tIiwiX2dhdGVJZFNldCIsImpvaW4iLCJTZXQiLCJnYXRlU3RhdHVzIiwiX2luaXQiLCJjbG9zZUR1cmF0aW9uIiwiY29vbGRvd25EdXJhdGlvbiIsImdhdGVTdGF0dXNCeUlkIiwib3BlbkR1cmF0aW9uIiwiUmVmbGVjdCIsImFwcGx5IiwicHJvdG90eXBlIiwiT2JqZWN0Iiwia2V5cyIsIl9pbml0VGltZSIsIkRhdGUiLCJub3ciLCJfdmFsaWRhdGVTdGF0dXMiLCJjb25zb2xlIiwibG9nIiwiaGFuZGxlRnVuY3Rpb24iLCJyZWplY3QiLCJyZXR1cm5WYWx1ZSIsImVycm9yIiwiaXNDbG9zaW5nT3JPcGVuaW5nIiwiX2V2ZW50cyIsImdhdGVDbG9zZWQiLCJhbGxvd1B1YmxpY1B1Ymxpc2giLCJhbGxvd1B1YmxpY1N1YnNjcmlwdGlvbiIsImFsbG93UHVibGljVW5zdWJzY3JpcHRpb24iLCJkZWZhdWx0RnVuY3Rpb24iLCJnYXRlQ2xvc2luZyIsImdhdGVPcGVuIiwiZ2F0ZU9wZW5pbmciLCJyZWFkeSJdLCJzb3VyY2VzIjpbIi4uL2pzL2dhdGUtbWFuYWdlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX0Vycm9yIGZyb20gJ2lzb3Ryb3BpYy1lcnJvcic7XG5pbXBvcnQgX2xhdGVyIGZyb20gJ2lzb3Ryb3BpYy1sYXRlcic7XG5pbXBvcnQgX21ha2UgZnJvbSAnaXNvdHJvcGljLW1ha2UnO1xuaW1wb3J0IF9QdWJzdWIgZnJvbSAnaXNvdHJvcGljLXB1YnN1Yic7XG5cbmV4cG9ydCBkZWZhdWx0IF9tYWtlKF9QdWJzdWIsIHtcbiAgICBjbG9zZUdhdGUgKHtcbiAgICAgICAgZ2F0ZUlkXG4gICAgfSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2ltdWxhdGVSZXF1ZXN0UmVzcG9uc2UoKCkgPT4gdGhpcy5fY2xvc2VHYXRlKHtcbiAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICB9KSk7XG4gICAgfSxcbiAgICBmZXRjaEdhdGVJZFNldCAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaW11bGF0ZVJlcXVlc3RSZXNwb25zZSgoKSA9PiB0aGlzLl9mZXRjaEdhdGVJZFNldCgpKTtcbiAgICB9LFxuICAgIGZldGNoR2F0ZVN0YXR1cyAoe1xuICAgICAgICBnYXRlSWRcbiAgICB9KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaW11bGF0ZVJlcXVlc3RSZXNwb25zZSgoKSA9PiB0aGlzLl9mZXRjaEdhdGVTdGF0dXMoe1xuICAgICAgICAgICAgZ2F0ZUlkXG4gICAgICAgIH0pKTtcbiAgICB9LFxuICAgIG9wZW5HYXRlICh7XG4gICAgICAgIGdhdGVJZFxuICAgIH0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NpbXVsYXRlUmVxdWVzdFJlc3BvbnNlKCgpID0+IHRoaXMuX29wZW5HYXRlKHtcbiAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICB9KSk7XG4gICAgfSxcbiAgICBfY2xvc2VHYXRlICh7XG4gICAgICAgIGdhdGVJZFxuICAgIH0pIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLl9nYXRlU3RhdHVzQnlJZFtnYXRlSWRdKSB7XG4gICAgICAgICAgICBjYXNlICdjbG9zZWQnOlxuICAgICAgICAgICAgY2FzZSAnY2xvc2luZyc6XG4gICAgICAgICAgICBjYXNlICdvcGVuaW5nJzpcbiAgICAgICAgICAgICAgICB0aHJvdyBfRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYXRlSWRcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJzQwOSBDYW4gbm90IGNsb3NlIGdhdGUgYXQgdGhpcyB0aW1lJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FzZSAnb3Blbic6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IF9FcnJvcih7XG4gICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnNDA0IEdhdGUgbm90IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzQ2xvc2luZ09yT3BlbmluZykge1xuICAgICAgICAgICAgdGhyb3cgX0Vycm9yKHtcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJzQwOSBDYW4gbm90IGNsb3NlIGdhdGUgYXQgdGhpcyB0aW1lJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9hZnRlcignZ2F0ZUNsb3NlZCcsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS5nYXRlSWQgPT09IGdhdGVJZCkge1xuICAgICAgICAgICAgICAgICAgICBldmVudC51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3B1Ymxpc2goJ2dhdGVDbG9zaW5nJywge1xuICAgICAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0IF9kZWxheSAoKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJhbmRvbSgpICogMTQ0O1xuICAgIH0sXG4gICAgX2V2ZW50R2F0ZUNsb3NlZCAoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnYXRlSWRcbiAgICAgICAgfVxuICAgIH0pIHtcbiAgICAgICAgdGhpcy5fZ2F0ZVN0YXR1c0J5SWRbZ2F0ZUlkXSA9ICdjbG9zZWQnO1xuXG4gICAgICAgIHRoaXMuX2xvZyhgZ2F0ZSAke2dhdGVJZH0gY2xvc2VkYCk7XG5cbiAgICAgICAgX2xhdGVyKHRoaXMuX2Nvb2xkb3duRHVyYXRpb24sICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3B1Ymxpc2goJ3JlYWR5Jyk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgX2V2ZW50R2F0ZUNsb3NpbmcgKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZ2F0ZUlkXG4gICAgICAgIH1cbiAgICB9KSB7XG4gICAgICAgIHRoaXMuX2dhdGVTdGF0dXNCeUlkW2dhdGVJZF0gPSAnY2xvc2luZyc7XG4gICAgICAgIHRoaXMuX2lzQ2xvc2luZ09yT3BlbmluZyA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5fbG9nKGBnYXRlICR7Z2F0ZUlkfSBjbG9zaW5nYCk7XG5cbiAgICAgICAgX2xhdGVyKHRoaXMuX2RlbGF5ICsgdGhpcy5fY2xvc2VEdXJhdGlvbiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcHVibGlzaCgnZ2F0ZUNsb3NlZCcsIHtcbiAgICAgICAgICAgICAgICBnYXRlSWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIF9ldmVudEdhdGVPcGVuICh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICB9XG4gICAgfSkge1xuICAgICAgICB0aGlzLl9nYXRlU3RhdHVzQnlJZFtnYXRlSWRdID0gJ29wZW4nO1xuXG4gICAgICAgIHRoaXMuX2xvZyhgZ2F0ZSAke2dhdGVJZH0gb3BlbmApO1xuXG4gICAgICAgIF9sYXRlcih0aGlzLl9jb29sZG93bkR1cmF0aW9uLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9wdWJsaXNoKCdyZWFkeScpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIF9ldmVudEdhdGVPcGVuaW5nICh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICB9XG4gICAgfSkge1xuICAgICAgICB0aGlzLl9nYXRlU3RhdHVzQnlJZFtnYXRlSWRdID0gJ29wZW5pbmcnO1xuICAgICAgICB0aGlzLl9pc0Nsb3NpbmdPck9wZW5pbmcgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuX2xvZyhgZ2F0ZSAke2dhdGVJZH0gb3BlbmluZ2ApO1xuXG4gICAgICAgIF9sYXRlcih0aGlzLl9kZWxheSArIHRoaXMuX29wZW5EdXJhdGlvbiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcHVibGlzaCgnZ2F0ZU9wZW4nLCB7XG4gICAgICAgICAgICAgICAgZ2F0ZUlkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBfZXZlbnRSZWFkeSAoKSB7XG4gICAgICAgIHRoaXMuX2lzQ2xvc2luZ09yT3BlbmluZyA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX2xvZygnZ2F0ZSBtYW5hZ2VyIHJlYWR5Jyk7XG4gICAgfSxcbiAgICBfZmV0Y2hHYXRlSWRTZXQgKCkge1xuICAgICAgICB0aGlzLl9sb2coYGdhdGUgaWRzOiAke0FycmF5LmZyb20odGhpcy5fZ2F0ZUlkU2V0KS5qb2luKCcsICcpfWApO1xuXG4gICAgICAgIHJldHVybiBuZXcgU2V0KHRoaXMuX2dhdGVJZFNldCk7XG4gICAgfSxcbiAgICBfZmV0Y2hHYXRlU3RhdHVzICh7XG4gICAgICAgIGdhdGVJZFxuICAgIH0pIHtcbiAgICAgICAgY29uc3QgZ2F0ZVN0YXR1cyA9IHRoaXMuX2dhdGVTdGF0dXNCeUlkW2dhdGVJZF07XG5cbiAgICAgICAgaWYgKCFnYXRlU3RhdHVzKSB7XG4gICAgICAgICAgICB0aHJvdyBfRXJyb3Ioe1xuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgZ2F0ZUlkXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnNDA0IEdhdGUgbm90IGZvdW5kJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9sb2coYGdhdGUgJHtnYXRlSWR9IGlzICR7Z2F0ZVN0YXR1c31gKTtcblxuICAgICAgICByZXR1cm4gZ2F0ZVN0YXR1cztcbiAgICB9LFxuICAgIF9pbml0ICh7XG4gICAgICAgIGNsb3NlRHVyYXRpb24gPSAzNzcsXG4gICAgICAgIGNvb2xkb3duRHVyYXRpb24gPSA5ODcsXG4gICAgICAgIGdhdGVTdGF0dXNCeUlkID0ge30sXG4gICAgICAgIG9wZW5EdXJhdGlvbiA9IDYxMFxuICAgIH0gPSB7fSkge1xuICAgICAgICBSZWZsZWN0LmFwcGx5KF9QdWJzdWIucHJvdG90eXBlLl9pbml0LCB0aGlzLCBbXSk7XG5cbiAgICAgICAgdGhpcy5fY2xvc2VEdXJhdGlvbiA9IGNsb3NlRHVyYXRpb247XG4gICAgICAgIHRoaXMuX2Nvb2xkb3duRHVyYXRpb24gPSBjb29sZG93bkR1cmF0aW9uO1xuICAgICAgICB0aGlzLl9nYXRlSWRTZXQgPSBuZXcgU2V0KE9iamVjdC5rZXlzKGdhdGVTdGF0dXNCeUlkKSk7XG4gICAgICAgIHRoaXMuX2dhdGVTdGF0dXNCeUlkID0gZ2F0ZVN0YXR1c0J5SWQ7XG4gICAgICAgIHRoaXMuX2luaXRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdGhpcy5faXNDbG9zaW5nT3JPcGVuaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX29wZW5EdXJhdGlvbiA9IG9wZW5EdXJhdGlvbjtcblxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsaWRhdGVTdGF0dXMoKTtcbiAgICB9LFxuICAgIF9sb2cgKG1lc3NhZ2UpIHtcbiAgICAgICAgY29uc29sZS5sb2coRGF0ZS5ub3coKSAtIHRoaXMuX2luaXRUaW1lLCBtZXNzYWdlKTtcbiAgICB9LFxuICAgIF9vcGVuR2F0ZSAoe1xuICAgICAgICBnYXRlSWRcbiAgICB9KSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5fZ2F0ZVN0YXR1c0J5SWRbZ2F0ZUlkXSkge1xuICAgICAgICAgICAgY2FzZSAnY2xvc2VkJzpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2Nsb3NpbmcnOlxuICAgICAgICAgICAgY2FzZSAnb3Blbic6XG4gICAgICAgICAgICBjYXNlICdvcGVuaW5nJzpcbiAgICAgICAgICAgICAgICB0aHJvdyBfRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYXRlSWRcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJzQwOSBDYW4gbm90IG9wZW4gZ2F0ZSBhdCB0aGlzIHRpbWUnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IF9FcnJvcih7XG4gICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnNDA0IEdhdGUgbm90IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzQ2xvc2luZ09yT3BlbmluZykge1xuICAgICAgICAgICAgdGhyb3cgX0Vycm9yKHtcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJzQwOSBDYW4gbm90IG9wZW4gZ2F0ZSBhdCB0aGlzIHRpbWUnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2FmdGVyKCdnYXRlT3BlbicsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS5nYXRlSWQgPT09IGdhdGVJZCkge1xuICAgICAgICAgICAgICAgICAgICBldmVudC51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3B1Ymxpc2goJ2dhdGVPcGVuaW5nJywge1xuICAgICAgICAgICAgICAgIGdhdGVJZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgX3NpbXVsYXRlUmVxdWVzdFJlc3BvbnNlIChoYW5kbGVGdW5jdGlvbikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgX2xhdGVyKHRoaXMuX2RlbGF5LCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV0dXJuVmFsdWUgPSBhd2FpdCBoYW5kbGVGdW5jdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgICAgIF9sYXRlcih0aGlzLl9kZWxheSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5WYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sYXRlcih0aGlzLl9kZWxheSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KF9FcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgX3ZhbGlkYXRlU3RhdHVzICgpIHtcbiAgICAgICAgbGV0IGlzQ2xvc2luZ09yT3BlbmluZyA9IGZhbHNlO1xuXG4gICAgICAgIGZvciAoY29uc3QgZ2F0ZUlkIG9mIHRoaXMuX2dhdGVJZFNldCkge1xuICAgICAgICAgICAgY29uc3QgZ2F0ZVN0YXR1cyA9IHRoaXMuX2dhdGVTdGF0dXNCeUlkW2dhdGVJZF07XG5cbiAgICAgICAgICAgIHN3aXRjaCAoZ2F0ZVN0YXR1cykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Nsb3NlZCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnb3Blbic6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Nsb3NpbmcnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ29wZW5pbmcnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNDbG9zaW5nT3JPcGVuaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2F0ZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnTXVsdGlwbGUgZ2F0ZXMgY2FuIG5vdCBiZSBjbG9zZWQgb3Igb3BlbmVkIGF0IHRoZSBzYW1lIHRpbWUnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlzQ2xvc2luZ09yT3BlbmluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IF9FcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2F0ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVTdGF0dXNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnR2F0ZSBoYXMgaW52YWxpZCBzdGF0dXMnXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faXNDbG9zaW5nT3JPcGVuaW5nID0gaXNDbG9zaW5nT3JPcGVuaW5nO1xuICAgICAgICB0aGlzLl9wdWJsaXNoKCdyZWFkeScpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59LCB7XG4gICAgX2V2ZW50czoge1xuICAgICAgICBnYXRlQ2xvc2VkOiB7XG4gICAgICAgICAgICBhbGxvd1B1YmxpY1B1Ymxpc2g6IGZhbHNlLFxuICAgICAgICAgICAgYWxsb3dQdWJsaWNTdWJzY3JpcHRpb246IGZhbHNlLFxuICAgICAgICAgICAgYWxsb3dQdWJsaWNVbnN1YnNjcmlwdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBkZWZhdWx0RnVuY3Rpb246ICdfZXZlbnRHYXRlQ2xvc2VkJ1xuICAgICAgICB9LFxuICAgICAgICBnYXRlQ2xvc2luZzoge1xuICAgICAgICAgICAgYWxsb3dQdWJsaWNQdWJsaXNoOiBmYWxzZSxcbiAgICAgICAgICAgIGFsbG93UHVibGljU3Vic2NyaXB0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIGFsbG93UHVibGljVW5zdWJzY3JpcHRpb246IGZhbHNlLFxuICAgICAgICAgICAgZGVmYXVsdEZ1bmN0aW9uOiAnX2V2ZW50R2F0ZUNsb3NpbmcnXG4gICAgICAgIH0sXG4gICAgICAgIGdhdGVPcGVuOiB7XG4gICAgICAgICAgICBhbGxvd1B1YmxpY1B1Ymxpc2g6IGZhbHNlLFxuICAgICAgICAgICAgYWxsb3dQdWJsaWNTdWJzY3JpcHRpb246IGZhbHNlLFxuICAgICAgICAgICAgYWxsb3dQdWJsaWNVbnN1YnNjcmlwdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBkZWZhdWx0RnVuY3Rpb246ICdfZXZlbnRHYXRlT3BlbidcbiAgICAgICAgfSxcbiAgICAgICAgZ2F0ZU9wZW5pbmc6IHtcbiAgICAgICAgICAgIGFsbG93UHVibGljUHVibGlzaDogZmFsc2UsXG4gICAgICAgICAgICBhbGxvd1B1YmxpY1N1YnNjcmlwdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBhbGxvd1B1YmxpY1Vuc3Vic2NyaXB0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIGRlZmF1bHRGdW5jdGlvbjogJ19ldmVudEdhdGVPcGVuaW5nJ1xuICAgICAgICB9LFxuICAgICAgICByZWFkeToge1xuICAgICAgICAgICAgYWxsb3dQdWJsaWNQdWJsaXNoOiBmYWxzZSxcbiAgICAgICAgICAgIGFsbG93UHVibGljU3Vic2NyaXB0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIGFsbG93UHVibGljVW5zdWJzY3JpcHRpb246IGZhbHNlLFxuICAgICAgICAgICAgZGVmYXVsdEZ1bmN0aW9uOiAnX2V2ZW50UmVhZHknXG4gICAgICAgIH1cbiAgICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBdUM7QUFBQSxlQUV4QixJQUFBQSxzQkFBSyxFQUFDQyx3QkFBTyxFQUFFO0VBQzFCQyxTQUFTLENBQUU7SUFDUEM7RUFDSixDQUFDLEVBQUU7SUFDQyxPQUFPLElBQUksQ0FBQ0Msd0JBQXdCLENBQUMsTUFBTSxJQUFJLENBQUNDLFVBQVUsQ0FBQztNQUN2REY7SUFDSixDQUFDLENBQUMsQ0FBQztFQUNQLENBQUM7RUFDREcsY0FBYyxHQUFJO0lBQ2QsT0FBTyxJQUFJLENBQUNGLHdCQUF3QixDQUFDLE1BQU0sSUFBSSxDQUFDRyxlQUFlLEVBQUUsQ0FBQztFQUN0RSxDQUFDO0VBQ0RDLGVBQWUsQ0FBRTtJQUNiTDtFQUNKLENBQUMsRUFBRTtJQUNDLE9BQU8sSUFBSSxDQUFDQyx3QkFBd0IsQ0FBQyxNQUFNLElBQUksQ0FBQ0ssZ0JBQWdCLENBQUM7TUFDN0ROO0lBQ0osQ0FBQyxDQUFDLENBQUM7RUFDUCxDQUFDO0VBQ0RPLFFBQVEsQ0FBRTtJQUNOUDtFQUNKLENBQUMsRUFBRTtJQUNDLE9BQU8sSUFBSSxDQUFDQyx3QkFBd0IsQ0FBQyxNQUFNLElBQUksQ0FBQ08sU0FBUyxDQUFDO01BQ3REUjtJQUNKLENBQUMsQ0FBQyxDQUFDO0VBQ1AsQ0FBQztFQUNERSxVQUFVLENBQUU7SUFDUkY7RUFDSixDQUFDLEVBQUU7SUFDQyxRQUFRLElBQUksQ0FBQ1MsZUFBZSxDQUFDVCxNQUFNLENBQUM7TUFDaEMsS0FBSyxRQUFRO01BQ2IsS0FBSyxTQUFTO01BQ2QsS0FB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